# WMAP

```sh
msf5 > set rhosts 192.160.58.3
rhosts => 192.160.58.3
msf5 > load wmap

.-.-.-..-.-.-..---..---.
| | | || | | || | || |-'
`-----'`-'-'-'`-^-'`-'
[WMAP 1.5.1] ===  et [  ] metasploit.com 2012
[*] Successfully loaded plugin: wmap   
msf5 > wmap_
wmap_modules  wmap_nodes    wmap_run      wmap_sites    wmap_targets  wmap_vulns    
msf5 > wmap_sites -h
[*] Usage: wmap_sites [options]
        -h        Display this help text
        -a [url]  Add site (vhost,url)
        -d [ids]  Delete sites (separate ids with space)
        -l        List all available sites
        -s [id]   Display site structure (vhost,url|ids) (level) (unicode output true/false)
msf5 > wmap_sites -a 192.160.58.3
[*] Site created.
msf5 > wmap_targets -h
[*] Usage: wmap_targets [options]
        -h              Display this help text
        -t [urls]       Define target sites (vhost1,url[space]vhost2,url) 
        -d [ids]        Define target sites (id1, id2, id3 ...)
        -c              Clean target sites list
        -l              List all target sites
```

```sh
msf5 > wmap_targets -t http://192.160.58.3
msf5 > wmap_sites -l
[*] Available sites
===============

     Id  Host          Vhost         Port  Proto  # Pages  # Forms
     --  ----          -----         ----  -----  -------  -------
     0   192.160.58.3  192.160.58.3  80    http   0        0


msf5 > wmap_targets -l
[*] Defined targets
===============

     Id  Vhost         Host          Port  SSL    Path
     --  -----         ----          ----  ---    ----
     0   192.160.58.3  192.160.58.3  80    false        /
```

```sh
msf5 > wmap_run -t
[*] Testing target:
[*]     Site: 192.160.58.3 (192.160.58.3)
[*]     Port: 80 SSL: false
============================================================
[*] Testing started. 2024-01-06 11:08:37 +0000
[*] Loading wmap modules...
[*] 39 wmap enabled modules loaded.
[*] 
=[ SSL testing ]=
============================================================
[*] Target is not SSL. SSL modules disabled.
[*] 
=[ Web Server testing ]=
============================================================
[*] Module auxiliary/scanner/http/http_version
[*] Module auxiliary/scanner/http/open_proxy
[*] Module auxiliary/admin/http/tomcat_administration
[*] Module auxiliary/admin/http/tomcat_utf8_traversal
[*] Module auxiliary/scanner/http/drupal_views_user_enum
[*] Module auxiliary/scanner/http/frontpage_login
[*] Module auxiliary/scanner/http/host_header_injection
[*] Module auxiliary/scanner/http/options
[*] Module auxiliary/scanner/http/robots_txt
[*] Module auxiliary/scanner/http/scraper
[*] Module auxiliary/scanner/http/svn_scanner
[*] Module auxiliary/scanner/http/trace
[*] Module auxiliary/scanner/http/vhost_scanner
[*] Module auxiliary/scanner/http/webdav_internal_ip
[*] Module auxiliary/scanner/http/webdav_scanner
[*] Module auxiliary/scanner/http/webdav_website_content
[*] 
=[ File/Dir testing ]=
============================================================
[*] Module auxiliary/scanner/http/backup_file
[*] Module auxiliary/scanner/http/brute_dirs
[*] Module auxiliary/scanner/http/copy_of_file
[*] Module auxiliary/scanner/http/dir_listing
[*] Module auxiliary/scanner/http/dir_scanner
[*] Module auxiliary/scanner/http/dir_webdav_unicode_bypass
[*] Module auxiliary/scanner/http/file_same_name_dir
[*] Module auxiliary/scanner/http/files_dir
[*] Module auxiliary/scanner/http/http_put
[*] Module auxiliary/scanner/http/ms09_020_webdav_unicode_bypass
[*] Module auxiliary/scanner/http/prev_dir_same_name_file
[*] Module auxiliary/scanner/http/replace_ext
[*] Module auxiliary/scanner/http/soap_xml
[*] Module auxiliary/scanner/http/trace_axd
[*] Module auxiliary/scanner/http/verb_auth_bypass
[*] 
=[ Unique Query testing ]=
============================================================
[*] Module auxiliary/scanner/http/blind_sql_query
[*] Module auxiliary/scanner/http/error_sql_injection
[*] Module auxiliary/scanner/http/http_traversal
[*] Module auxiliary/scanner/http/rails_mass_assignment
[*] Module exploit/multi/http/lcms_php_exec
[*] 
=[ Query testing ]=
============================================================
[*] 
=[ General testing ]=
============================================================
[*] Done.
```

```sh
msf5 > wmap_run -e
[*] Using ALL wmap enabled modules.
[-] NO WMAP NODES DEFINED. Executing local modules
[*] Testing target:
[*]     Site: 192.160.58.3 (192.160.58.3)
[*]     Port: 80 SSL: false
============================================================
[*] Testing started. 2024-01-06 11:12:01 +0000
[*] 
=[ SSL testing ]=
============================================================
[*] Target is not SSL. SSL modules disabled.
[*] 
=[ Web Server testing ]=
============================================================
[*] Module auxiliary/scanner/http/http_version

[+] 192.160.58.3:80 Apache/2.4.18 (Ubuntu)
[*] Module auxiliary/scanner/http/open_proxy
[*] Module auxiliary/admin/http/tomcat_administration
[*] Module auxiliary/admin/http/tomcat_utf8_traversal
[*] Attempting to connect to 192.160.58.3:80
[+] No File(s) found
[*] Module auxiliary/scanner/http/drupal_views_user_enum
[-] 192.160.58.3 does not appear to be vulnerable, will not continue
[*] Module auxiliary/scanner/http/frontpage_login
[*] 192.160.58.3:80       - http://192.160.58.3/ may not support FrontPage Server Extensions
[*] Module auxiliary/scanner/http/host_header_injection
[*] Module auxiliary/scanner/http/options
[+] 192.160.58.3 allows OPTIONS,GET,HEAD,POST methods
[*] Module auxiliary/scanner/http/robots_txt
[*] [192.160.58.3] /robots.txt found
[+] Contents of Robots.txt:
# robots.txt for attackdefense 
User-agent: test                     
# Directories
Allow: /webmail

User-agent: *
# Directories
Disallow: /data
Disallow: /secure

[*] Module auxiliary/scanner/http/scraper
[+] [192.160.58.3] / [Apache2 Ubuntu Default Page: It works]
[*] Module auxiliary/scanner/http/svn_scanner
[*] Using code '404' as not found.
[*] Module auxiliary/scanner/http/trace
[*] Module auxiliary/scanner/http/vhost_scanner
[*] [192.160.58.3] Sending request with random domain fLsfo. 
[*] [192.160.58.3] Sending request with random domain ESuZA. 
[*] Module auxiliary/scanner/http/webdav_internal_ip
[*] Module auxiliary/scanner/http/webdav_scanner
[*] 192.160.58.3 (Apache/2.4.18 (Ubuntu)) WebDAV disabled.
[*] Module auxiliary/scanner/http/webdav_website_content
[*] 
=[ File/Dir testing ]=
============================================================
[*] Module auxiliary/scanner/http/backup_file
[*] Module auxiliary/scanner/http/brute_dirs
[*] Path: /
[*] Using code '404' as not found.
[+] Found http://192.160.58.3:80/doc/ 200
[+] Found http://192.160.58.3:80/pro/ 200
[*] Module auxiliary/scanner/http/copy_of_file
[*] Module auxiliary/scanner/http/dir_listing
[*] Path: /
[*] Module auxiliary/scanner/http/dir_scanner
[*] Path: /
[*] Detecting error code
[*] Using code '404' as not found for 192.160.58.3
[+] Found http://192.160.58.3:80/cgi-bin/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/data/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/downloads/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/doc/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/icons/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/manual/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/secure/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/users/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/uploads/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/webadmin/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/view/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/web_app/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/webdav/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/webdb/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/webmail/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/~nobody/ 404 (192.160.58.3)
[+] Found http://192.160.58.3:80/~admin/ 404 (192.160.58.3)
[*] Module auxiliary/scanner/http/dir_webdav_unicode_bypass
[*] Path: /
[*] Using code '404' as not found.
[*] Found protected folder http://192.160.58.3:80/secure/ 401 (192.160.58.3)
[*]     Testing for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.
[*] Found protected folder http://192.160.58.3:80/webdav/ 401 (192.160.58.3)
[*]     Testing for unicode bypass in IIS6 with WebDAV enabled using PROPFIND request.
[*] Module auxiliary/scanner/http/file_same_name_dir
[*] Path: /
[-] Blank or default PATH set.
[*] Module auxiliary/scanner/http/files_dir
[*] Path: /
[*] Using code '404' as not found for files with extension .null
[*] Using code '404' as not found for files with extension .backup
[+] Found http://192.160.58.3:80/file.backup 200
[*] Using code '404' as not found for files with extension .bak
[*] Using code '404' as not found for files with extension .c
[+] Found http://192.160.58.3:80/code.c 200
[*] Using code '404' as not found for files with extension .cfg
[+] Found http://192.160.58.3:80/code.cfg 200
[*] Using code '404' as not found for files with extension .class
[*] Using code '404' as not found for files with extension .copy
[*] Using code '404' as not found for files with extension .conf
[*] Using code '404' as not found for files with extension .exe
[*] Using code '404' as not found for files with extension .html
[+] Found http://192.160.58.3:80/index.html 200
[*] Using code '404' as not found for files with extension .htm
[*] Using code '404' as not found for files with extension .ini
[*] Using code '404' as not found for files with extension .log
[*] Using code '404' as not found for files with extension .old
[*] Using code '404' as not found for files with extension .orig
[*] Using code '404' as not found for files with extension .php
[+] Found http://192.160.58.3:80/test.php 200
[*] Using code '404' as not found for files with extension .tar
[*] Using code '404' as not found for files with extension .tar.gz
[*] Using code '404' as not found for files with extension .tgz
[*] Using code '404' as not found for files with extension .tmp
[*] Using code '404' as not found for files with extension .temp
[*] Using code '404' as not found for files with extension .txt
[*] Using code '404' as not found for files with extension .zip
[*] Using code '404' as not found for files with extension ~
[*] Using code '404' as not found for files with extension 
[+] Found http://192.160.58.3:80/cgi-bin 301
[+] Found http://192.160.58.3:80/data 301
[+] Found http://192.160.58.3:80/doc 301
[+] Found http://192.160.58.3:80/downloads 301
[+] Found http://192.160.58.3:80/manual 301
[+] Found http://192.160.58.3:80/secure 401
[+] Found http://192.160.58.3:80/users 301
[+] Found http://192.160.58.3:80/uploads 301
[+] Found http://192.160.58.3:80/view 301
[+] Found http://192.160.58.3:80/webdav 401
[+] Found http://192.160.58.3:80/webadmin 301
[+] Found http://192.160.58.3:80/webmail 301
[+] Found http://192.160.58.3:80/~mail 403
[+] Found http://192.160.58.3:80/~bin 403
[+] Found http://192.160.58.3:80/~admin 403
[+] Found http://192.160.58.3:80/~sys 403
[*] Using code '404' as not found for files with extension 
[+] Found http://192.160.58.3:80/cgi-bin 301
[+] Found http://192.160.58.3:80/data 301
[+] Found http://192.160.58.3:80/doc 301
[+] Found http://192.160.58.3:80/downloads 301
[+] Found http://192.160.58.3:80/manual 301
[+] Found http://192.160.58.3:80/secure 401
[+] Found http://192.160.58.3:80/uploads 301
[+] Found http://192.160.58.3:80/users 301
[+] Found http://192.160.58.3:80/webdav 401
[+] Found http://192.160.58.3:80/view 301
[+] Found http://192.160.58.3:80/webadmin 301
[+] Found http://192.160.58.3:80/webmail 301
[+] Found http://192.160.58.3:80/~bin 403
[+] Found http://192.160.58.3:80/~admin 403
[+] Found http://192.160.58.3:80/~mail 403
[+] Found http://192.160.58.3:80/~sys 403
[*] Module auxiliary/scanner/http/http_put
[*] Path: /
[-] 192.160.58.3: File doesn't seem to exist. The upload probably failed
[*] Module auxiliary/scanner/http/ms09_020_webdav_unicode_bypass
[*] Path: /
[-] 192.160.58.3:80 Folder does not require authentication. [405]
[*] Module auxiliary/scanner/http/prev_dir_same_name_file
[*] Path: /
[-] Blank or default PATH set.
[*] Module auxiliary/scanner/http/replace_ext
[*] Module auxiliary/scanner/http/soap_xml
[*] Path: /
[*] Starting scan with 0ms delay between requests
[*] Server 192.160.58.3:80 returned HTTP 404 for /.  Use a different one.
[*] Module auxiliary/scanner/http/trace_axd
[*] Path: /
[*] Module auxiliary/scanner/http/verb_auth_bypass
[*] 
=[ Unique Query testing ]=
============================================================
[*] Module auxiliary/scanner/http/blind_sql_query
[*] Module auxiliary/scanner/http/error_sql_injection
[*] Module auxiliary/scanner/http/http_traversal
[*] Module auxiliary/scanner/http/rails_mass_assignment
[*] Module exploit/multi/http/lcms_php_exec
[*] 
=[ Query testing ]=
============================================================
[*] 
=[ General testing ]=
============================================================
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Launch completed in 290.6321270465851 seconds.
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
[*] Done.
```

```sh
msf5 > 
msf5 > wmap_vulns -h
[*] Usage: wmap_vulns [options]
        -h              Display this help text
        -l              Display web vulns table

msf5 > wmap_vulns -l
[*] + [192.160.58.3] (192.160.58.3): scraper /
[*]     scraper Scraper
[*]     GET Apache2 Ubuntu Default Page: It works
[*] + [192.160.58.3] (192.160.58.3): directory /pro/
[*]     directory Directory found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /cgi-bin/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /data/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /downloads/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /doc/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /icons/
[*]     directory Directoy found.
[*]     GET Res code: 403
[*] + [192.160.58.3] (192.160.58.3): directory /manual/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /secure/
[*]     directory Directoy found.
[*]     GET Res code: 401
[*] + [192.160.58.3] (192.160.58.3): directory /users/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /uploads/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /webadmin/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /view/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /web_app/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /webmail/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /webdav/
[*]     directory Directoy found.
[*]     GET Res code: 401
[*] + [192.160.58.3] (192.160.58.3): directory /webdb/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): directory /~nobody/
[*]     directory Directoy found.
[*]     GET Res code: 403
[*] + [192.160.58.3] (192.160.58.3): directory /~admin/
[*]     directory Directoy found.
[*]     GET Res code: 403
[*] + [192.160.58.3] (192.160.58.3): file /file.backup
[*]     file File found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): file /code.c
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /code.cfg
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /index.html
[*]     file File found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): file /test.php
[*]     file File found.
[*]     GET Res code: 200
[*] + [192.160.58.3] (192.160.58.3): file /data
[*]     file File found.
[*]     GET Res code: 301
[*] + [192.160.58.3] (192.160.58.3): file /doc
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /downloads
[*]     file File found.
[*]     GET Res code: 301
[*] + [192.160.58.3] (192.160.58.3): file /secure
[*]     file File found.
[*]     GET Res code: 401
[*] + [192.160.58.3] (192.160.58.3): file /uploads
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /webmail
[*]     file File found.
[*]     GET Res code: 301
[*] + [192.160.58.3] (192.160.58.3): file /~admin
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /~bin
[*]     file File found.
[*]     GET Res code: 403
[*] + [192.160.58.3] (192.160.58.3): file /~mail
[*]     file File found.
[*]     GET Res code: 403
[*] + [192.160.58.3] (192.160.58.3): file /~sys
[*]     file File found.
[*]     GET Res code: 403
[*] + [192.160.58.3] (192.160.58.3): file /cgi-bin
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /manual
[*]     file File found.
[*]     GET Res code: 301
[*] + [192.160.58.3] (192.160.58.3): file /users
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /webadmin
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /view
[*]     file File found.
[*]     GET Res code: 404
[*] + [192.160.58.3] (192.160.58.3): file /webdav
[*]     file File found.
[*]     GET Res code: 404
```
